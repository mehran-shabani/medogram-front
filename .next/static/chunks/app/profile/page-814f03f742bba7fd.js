(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4178],{9727:function(e,t,r){Promise.resolve().then(r.bind(r,6097))},6097:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var a=r(7437),n=r(2265),i=r(3464),s=r(7261);r(2648);var o=r(7208),l=r(7116),c=r(5656),h=r(3410),d=r(9327),u=r(5389),m=r(486),p=r(6137),x=r(6387),g=r(8350),f=r(9735),j=r(1586),v=r(9832),y=r(4013),Z=r(9084),b=r(4574),w=r(4689),C=r(4853),M=r(4862),k=r(9530);let I=e=>{let t=e.split("").reduce((e,t,r)=>t.charCodeAt(0)+((e<<5)-e)+r,0),r=(e=>{let t=e%360;return[`hsl(${t}, 70%, 45%)`,`hsl(${(t+30)%360}, 60%, 50%)`,`hsl(${(t+60)%360}, 50%, 55%)`]})(t),n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=(1+Math.sqrt(5))/2,a=[];for(let n=0;n<e;n++){let e=n*r*2*Math.PI,i=Math.sqrt(n)*t,s=50+i*Math.cos(e),o=50+i*Math.sin(e);a.push({x:s,y:o})}return a}(8,3);return(0,a.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("radialGradient",{id:"backgroundGradient",children:[(0,a.jsx)("stop",{offset:"0%",style:{stopColor:r[0],stopOpacity:.9}}),(0,a.jsx)("stop",{offset:"100%",style:{stopColor:r[1],stopOpacity:.7}})]}),(0,a.jsxs)("filter",{id:"glow",children:[(0,a.jsx)("feGaussianBlur",{stdDeviation:"1",result:"coloredBlur"}),(0,a.jsxs)("feMerge",{children:[(0,a.jsx)("feMergeNode",{in:"coloredBlur"}),(0,a.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),(0,a.jsx)("rect",{width:"100",height:"100",fill:"url(#backgroundGradient)"}),(0,a.jsx)("g",{filter:"url(#glow)",children:(0,a.jsx)("path",{d:((e,t)=>{let r="";for(let a=0;a<e;a++){let n=360*a/e,i=t*Math.cos(n*Math.PI/180),s=t*Math.sin(n*Math.PI/180),o=.5*t*Math.cos((n+30)*Math.PI/180),l=.5*t*Math.sin((n+30)*Math.PI/180),c=.5*t*Math.cos((n-30)*Math.PI/180),h=.5*t*Math.sin((n-30)*Math.PI/180);r+=`M 50 50 C ${50+o} ${50+l}, ${50+c} ${50+h}, ${50+i} ${50+s}`}return r})(8+t%6*2,35),fill:"none",stroke:r[2],strokeWidth:"0.5",opacity:"0.8"})}),n.map((e,t)=>(0,a.jsx)("circle",{cx:e.x,cy:e.y,r:1.5,fill:r[2],opacity:"0.6"},t)),[1,2].map((e,t)=>(0,a.jsx)("circle",{cx:"50",cy:"50",r:20+10*e,fill:"none",stroke:r[1],strokeWidth:"0.2",opacity:"0.3"},`ring-${t}`)),(0,a.jsx)("g",{filter:"url(#glow)",children:(0,a.jsx)("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"24",fontFamily:"Arial, sans-serif",fill:"#FFFFFF",style:{textTransform:"uppercase",fontWeight:"bold"},children:e.charAt(0)})})]})};var S=r(6298);let $=(0,Z.Z)(o.Z)(e=>{let{theme:t}=e;return{maxWidth:500,margin:"2rem auto",padding:t.spacing(3),boxShadow:"0 8px 30px rgba(0,0,0,0.2)",borderRadius:3*t.shape.borderRadius,transition:"transform 0.5s","&:hover":{transform:"scale(1.05)"}}}),A=(0,Z.Z)(l.Z)(e=>{let{theme:t}=e;return{width:t.spacing(15),height:t.spacing(15),margin:"0 auto",backgroundColor:t.palette.primary.main,display:"flex",alignItems:"center",justifyContent:"center"}}),B=(0,Z.Z)(c.Z)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",marginBottom:t.spacing(2)}}),E=(0,Z.Z)(h.Z)(e=>{let{theme:t}=e;return{padding:t.spacing(2),display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:t.palette.primary.light,color:t.palette.primary.contrastText,marginBottom:t.spacing(2),borderRadius:t.shape.borderRadius,boxShadow:"0px 4px 10px rgba(0,0,0,0.15)",transition:"background-color 0.5s","&:hover":{backgroundColor:t.palette.secondary.light}}});var P=()=>{let{isVerified:e,token:t}=(0,n.useContext)(k.V),[r,o]=(0,n.useState)({username:"",email:""}),[l,h]=(0,n.useState)(null),[Z,P]=(0,n.useState)(!0),[F,W]=(0,n.useState)({}),[_,T]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!e){s.Am.error("لطفاً حساب خود را تایید کنید تا به صفحه پروفایل دسترسی داشته باشید."),setTimeout(()=>{window.location.href="/login"},3e3);return}(async()=>{try{let[e,r]=await Promise.all([i.Z.get("https://api.medogram.ir/api/profile/",{headers:{Authorization:`Bearer ${t}`}}),i.Z.get("https://api.medogram.ir/api/box",{headers:{Authorization:`Bearer ${t}`}})]);o(e.data),h(r.data.amount)}catch(e){console.error("خطا در دریافت اطلاعات:",e.response||e.message),s.Am.error("خطا در دریافت اطلاعات پروفایل یا کیف پول!")}finally{P(!1)}})()},[e,t]);let H=e=>{o({...r,[e.target.name]:e.target.value})},D=async e=>{e.preventDefault();try{let e=await i.Z.post("https://api.medogram.ir/api/profile/update/",r,{headers:{Authorization:`Bearer ${t}`}});o(e.data),W({}),T(!1),s.Am.success("پروفایل با موفقیت به‌روزرسانی شد!")}catch(e){console.error("خطا در به‌روزرسانی پروفایل:",e.response||e.message),e.response&&e.response.data&&W(e.response.data),s.Am.error("خطا در به‌روزرسانی پروفایل!")}};return Z?(0,a.jsx)(d.Z,{children:(0,a.jsx)(c.Z,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",children:(0,a.jsx)(u.Z,{})})}):(0,a.jsxs)(d.Z,{maxWidth:"sm",children:[(0,a.jsx)(s.Ix,{position:"top-right",autoClose:5e3,hideProgressBar:!1}),(0,a.jsx)(m.Z,{in:!0,timeout:800,children:(0,a.jsxs)($,{component:S.E.div,initial:{opacity:0},animate:{opacity:1},whileHover:{scale:1.05},children:[(0,a.jsxs)(p.Z,{children:[(0,a.jsx)(S.E.div,{animate:{rotate:[0,360]},transition:{duration:2,repeat:1/0},children:(0,a.jsx)(A,{children:I(r.username)})}),(0,a.jsx)(x.Z,{variant:"h4",component:"h1",align:"center",gutterBottom:!0,sx:{mt:2},children:r.username}),(0,a.jsx)(g.Z,{sx:{my:2}}),(0,a.jsxs)(E,{elevation:3,component:S.E.div,initial:{scale:.8},animate:{scale:1},whileHover:{scale:1.1},children:[(0,a.jsx)(b.Z,{sx:{mr:1}}),(0,a.jsxs)(x.Z,{variant:"h6",children:["موجودی کیف پول: \uD83D\uDCB5  ﷼ ",null!==l?l.toFixed(0):"N/A"]})]}),_?(0,a.jsxs)("form",{onSubmit:D,children:[(0,a.jsx)(f.Z,{fullWidth:!0,label:"نام کاربری",name:"username",value:r.username,onChange:H,error:!!F.username,helperText:F.username,variant:"outlined",margin:"normal"}),(0,a.jsx)(f.Z,{fullWidth:!0,label:"ایمیل",name:"email",type:"email",value:r.email,onChange:H,error:!!F.email,helperText:F.email,variant:"outlined",margin:"normal"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(B,{children:[(0,a.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:"bold",mr:1},children:"نام کاربری:"}),(0,a.jsx)(x.Z,{variant:"body1",children:r.username})]}),(0,a.jsxs)(B,{children:[(0,a.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:"bold",mr:1},children:"ایمیل:"}),(0,a.jsx)(x.Z,{variant:"body1",children:r.email})]})]})]}),(0,a.jsx)(j.Z,{sx:{justifyContent:"center"},children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.Z,{color:"primary",onClick:D,component:S.E.div,whileHover:{scale:1.2},children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)(v.Z,{color:"secondary",onClick:()=>T(!1),component:S.E.div,whileHover:{scale:1.2},children:(0,a.jsx)(C.Z,{})})]}):(0,a.jsx)(y.Z,{variant:"contained",color:"primary",startIcon:(0,a.jsx)(M.Z,{}),onClick:()=>T(!0),component:S.E.div,whileHover:{scale:1.1},children:"ویرایش پروفایل"})})]})})]})};function F(){return(0,a.jsx)(P,{})}},9530:function(e,t,r){"use strict";r.d(t,{H:function(){return o},V:function(){return s}});var a=r(7437),n=r(2265),i=r(3464);let s=(0,n.createContext)(),o=e=>{let{children:t}=e,[r,o]=(0,n.useState)(!1),[l,c]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=localStorage.getItem("authToken");e&&(c(e),o(!0))},[]),(0,n.useEffect)(()=>{let e=i.Z.interceptors.request.use(e=>(l&&(e.headers.Authorization=`Bearer ${l}`),e),e=>Promise.reject(e));return()=>{i.Z.interceptors.request.eject(e)}},[l]),(0,a.jsx)(s.Provider,{value:{isVerified:r,registerUser:e=>i.Z.post("https://api.medogram.ir/api/register/",{phone_number:e}),verifyUser:(e,t)=>(console.log("Data being sent:",{phone_number:e,code:t}),i.Z.post("https://api.medogram.ir/api/verify/",{code:t,phone_number:e}).then(e=>{let t=e.data?.access;if(!t)throw Error("توکن در پاسخ سرور موجود نیست!");return o(!0),c(t),localStorage.setItem("authToken",t),t}).catch(e=>{throw console.error("Verification error:",e.response?.data),e})),token:l,logout:()=>{o(!1),c(null),localStorage.removeItem("authToken")}},children:t})}}},function(e){e.O(0,[5676,5040,6298,3464,2276,9078,4013,344,6697,5548,6565,2971,2117,1744],function(){return e(e.s=9727)}),_N_E=e.O()}]);