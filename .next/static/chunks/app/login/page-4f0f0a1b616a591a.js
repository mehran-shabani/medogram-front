(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{2399:function(e,r,t){Promise.resolve().then(t.bind(t,3981))},3981:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return X}});var a=t(7437),o=t(2265),n=t(9379),i=t(6298),l=t(9376),s=t(5656),c=t(6387),d=t(9735),u=t(5860),m=t(1994),h=t(801),p=t(8417),g=t(6183),b=t(2464),f=(0,b.Z)((0,a.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),v=(0,b.Z)((0,a.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),x=(0,b.Z)((0,a.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),Z=t(5657),y=t(4765),j=t(4143),k=t(738);function w(e){return(0,k.ZP)("MuiCheckbox",e)}let C=(0,j.Z)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]);var A=t(6210),P=t(1086),S=t(3858),R=t(7053);let z=e=>{let{classes:r,indeterminate:t,color:a,size:o}=e,n={root:["root",t&&"indeterminate",`color${(0,Z.Z)(a)}`,`size${(0,Z.Z)(o)}`]},i=(0,h.Z)(n,w,r);return{...r,...i}},E=(0,A.ZP)(g.Z,{shouldForwardProp:e=>(0,y.Z)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:t}=e;return[r.root,t.indeterminate&&r.indeterminate,r[`size${(0,Z.Z)(t.size)}`],"default"!==t.color&&r[`color${(0,Z.Z)(t.color)}`]]}})((0,P.Z)(e=>{let{theme:r}=e;return{color:(r.vars||r).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:(0,p.Fq)(r.palette.action.active,r.palette.action.hoverOpacity)}}},...Object.entries(r.palette).filter((0,S.Z)()).map(e=>{let[t]=e;return{props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette[t].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:(0,p.Fq)(r.palette[t].main,r.palette.action.hoverOpacity)}}}}),...Object.entries(r.palette).filter((0,S.Z)()).map(e=>{let[t]=e;return{props:{color:t},style:{[`&.${C.checked}, &.${C.indeterminate}`]:{color:(r.vars||r).palette[t].main},[`&.${C.disabled}`]:{color:(r.vars||r).palette.action.disabled}}}}),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}})),$=(0,a.jsx)(v,{}),L=(0,a.jsx)(f,{}),N=(0,a.jsx)(x,{}),F=o.forwardRef(function(e,r){let t=(0,R.i)({props:e,name:"MuiCheckbox"}),{checkedIcon:n=$,color:i="primary",icon:l=L,indeterminate:s=!1,indeterminateIcon:c=N,inputProps:d,size:u="medium",disableRipple:h=!1,className:p,...g}=t,b=s?c:l,f=s?c:n,v={...t,disableRipple:h,color:i,indeterminate:s,size:u},x=z(v);return(0,a.jsx)(E,{type:"checkbox",inputProps:{"data-indeterminate":s,...d},icon:o.cloneElement(b,{fontSize:b.props.fontSize??u}),checkedIcon:o.cloneElement(f,{fontSize:f.props.fontSize??u}),ownerState:v,ref:r,className:(0,m.Z)(x.root,p),disableRipple:h,...g,classes:x})});var H=t(4013),I=t(5389),M=t(7261);t(2648);var B=t(9530),T=t(3464);let O=async e=>{if(!e)throw Error("توکن احراز هویت یافت نشد.");try{return(await T.Z.get("https://api.medogram.ir/api/username/",{headers:{Authorization:`Bearer ${e}`}})).data}catch(e){throw Error(e.response?.data?.message||"خطا در دریافت یوزرنیم")}},W=async(e,r)=>{if(!e)throw Error("توکن احراز هویت یافت نشد.");try{return(await T.Z.post("https://api.medogram.ir/api/username/update/",{username:r},{headers:{Authorization:`Bearer ${e}`}})).data}catch(e){throw Error(e.response?.data?.message||"خطا در به‌روزرسانی یوزرنیم")}},V=(0,A.ZP)(s.Z)(e=>{let{theme:r}=e;return{maxWidth:500,margin:"50px auto",padding:r.spacing(4),borderRadius:"12px",background:"white",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)"}});var q=()=>{let[e,r]=(0,o.useState)({step:"phone",phoneNumber:"",authCode:"",username:"",agreeToTerms:!1,loading:!1}),{registerUser:t,verifyUser:n,token:i}=(0,o.useContext)(B.V),m=(0,l.useRouter)(),h=async()=>{if(!/^09\d{9}$/.test(e.phoneNumber)){M.Am.error("شماره موبایل باید با 09 شروع شود و 11 رقم باشد.");return}r(e=>({...e,loading:!0}));try{await t(e.phoneNumber),M.Am.success("کد احراز هویت ارسال شد."),r(e=>({...e,step:"verify"}))}catch(e){M.Am.error("ارسال کد با خطا مواجه شد.")}finally{r(e=>({...e,loading:!1}))}},p=async()=>{if(!e.agreeToTerms){M.Am.error("لطفاً شرایط و ضوابط را بپذیرید.");return}if(6!==e.authCode.length){M.Am.error("کد تایید باید 6 رقمی باشد.");return}r(e=>({...e,loading:!0}));try{let t=await n(e.phoneNumber,e.authCode);if(!t)throw Error("توکن دریافت نشد یا کد اشتباه بود!");(await O(t)).username===e.phoneNumber?r(e=>({...e,step:"collectUsername"})):(M.Am.success("ورود موفقیت‌آمیز"),m.push("/"))}catch(e){M.Am.error(e.message||"کد واردشده صحیح نیست")}finally{r(e=>({...e,loading:!1}))}},g=async()=>{if(!e.username){M.Am.error("لطفاً نام و نام خانوادگی خود را وارد کنید.");return}r(e=>({...e,loading:!0}));try{await W(i,e.username),M.Am.success("نام و نام خانوادگی با موفقیت ثبت شد."),m.push("/")}catch(e){M.Am.error(e.message||"ذخیره اطلاعات با خطا مواجه شد.")}finally{r(e=>({...e,loading:!1}))}};return(0,a.jsxs)(V,{children:["phone"===e.step&&(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(c.Z,{variant:"h5",mb:2,children:"ورود به حساب کاربری"}),(0,a.jsx)(d.Z,{fullWidth:!0,label:"شماره موبایل",value:e.phoneNumber,onChange:t=>r({...e,phoneNumber:t.target.value}),disabled:e.loading,margin:"normal"}),(0,a.jsx)(u.Z,{control:(0,a.jsx)(F,{checked:e.agreeToTerms,onChange:t=>r({...e,agreeToTerms:t.target.checked})}),label:(0,a.jsxs)(c.Z,{variant:"body2",children:[(0,a.jsx)("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",style:{color:"#1976d2",textDecoration:"none"},children:"شرایط و ضوابط"})," ","را می‌پذیرم."]})}),(0,a.jsx)(H.Z,{fullWidth:!0,variant:"contained",onClick:h,disabled:e.loading,children:e.loading?(0,a.jsx)(I.Z,{size:24}):"ارسال کد"})]}),"verify"===e.step&&(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(c.Z,{variant:"h5",mb:2,children:"تایید کد"}),(0,a.jsx)(d.Z,{fullWidth:!0,label:"کد تایید",value:e.authCode,onChange:t=>r({...e,authCode:t.target.value}),disabled:e.loading,margin:"normal"}),(0,a.jsx)(H.Z,{fullWidth:!0,variant:"contained",onClick:p,disabled:e.loading,children:e.loading?(0,a.jsx)(I.Z,{size:24}):"تایید"})]}),"collectUsername"===e.step&&(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(c.Z,{variant:"h5",mb:2,children:"ثبت نام و نام خانوادگی"}),(0,a.jsx)(d.Z,{fullWidth:!0,label:"نام و نام خانوادگی",value:e.username,onChange:t=>r({...e,username:t.target.value}),disabled:e.loading,margin:"normal"}),(0,a.jsx)(H.Z,{fullWidth:!0,variant:"contained",onClick:g,disabled:e.loading,children:e.loading?(0,a.jsx)(I.Z,{size:24}):"ذخیره"})]}),"loading"===e.step&&(0,a.jsxs)(s.Z,{textAlign:"center",children:[(0,a.jsx)(I.Z,{size:40}),(0,a.jsx)(c.Z,{mt:2,children:"در حال بارگذاری، لطفاً صبر کنید..."})]}),(0,a.jsx)(M.Ix,{})]})},D={src:"/_next/static/media/medogram-logo.6af0d0c9.png",height:1341,width:1341,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA7UlEQVR42i2PXUrDQBSFxy24BHeSdllSVxEi+CIIgm9FCKESfS5tE38CMzGktsGXJLQxOpmZiGN7Ogz94MLlfvfhHJLn+QkxRFHkvKfMZVnmLsxODEVRWEcopedVXaHlHF3ToK4qmNvIyng+d8q6ht5ssHx41OHsTX9yaZ5KLKJ4QBilrlQKUFKXYYinmKHpf3WvJChjHkmSxO2EgNhBN1yi+u4g9E4LKWGcR15fnp3lag3+t8eP6HXLle7+gdW6wGw6Hdocvh+MsjRFu93iy8xHnmM8vr+w8oyc2io3t3cDP5h4wST0Lq+uh+TIAQwms/bsPjjAAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8};let _=n.ZP.div.withConfig({componentId:"sc-90191380-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:2rem;"]),K=(0,n.ZP)(i.E.div).withConfig({componentId:"sc-90191380-1"})(["background:rgba(255,255,255,0.95);border-radius:20px;padding:3rem 2rem;box-shadow:0 15px 35px rgba(0,0,0,0.1);width:100%;max-width:450px;display:flex;flex-direction:column;align-items:center;"]),U=n.ZP.h1.withConfig({componentId:"sc-90191380-2"})(["font-size:2.5rem;color:#333;margin-bottom:2rem;text-align:center;font-weight:700;"]),Q=n.ZP.img.withConfig({componentId:"sc-90191380-3"})(["width:120px;height:auto;margin-bottom:2rem;transition:transform 0.3s ease;&:hover{transform:scale(1.05);}"]);var G=()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(_,{children:(0,a.jsxs)(K,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,a.jsx)(Q,{src:D,alt:"Medogram Logo"}),(0,a.jsx)(U,{children:"Welcome to Medogram"}),(0,a.jsx)(q,{})]})})});function X(){return(0,a.jsx)(G,{})}},5860:function(e,r,t){"use strict";t.d(r,{Z:function(){return j}});var a=t(2265),o=t(1994),n=t(801),i=t(6515),l=t(6210),s=t(1086),c=t(7053),d=t(6387),u=t(5657),m=t(4143),h=t(738);function p(e){return(0,h.ZP)("MuiFormControlLabel",e)}let g=(0,m.Z)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]);var b=t(8904),f=t(9114),v=t(7437);let x=e=>{let{classes:r,disabled:t,labelPlacement:a,error:o,required:i}=e,l={root:["root",t&&"disabled",`labelPlacement${(0,u.Z)(a)}`,o&&"error",i&&"required"],label:["label",t&&"disabled"],asterisk:["asterisk",o&&"error"]};return(0,n.Z)(l,p,r)},Z=(0,l.ZP)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:t}=e;return[{[`& .${g.label}`]:r.label},r.root,r[`labelPlacement${(0,u.Z)(t.labelPlacement)}`]]}})((0,s.Z)(e=>{let{theme:r}=e;return{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${g.disabled}`]:{cursor:"default"},[`& .${g.label}`]:{[`&.${g.disabled}`]:{color:(r.vars||r).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:e=>{let{labelPlacement:r}=e;return"start"===r||"top"===r||"bottom"===r},style:{marginLeft:16}}]}})),y=(0,l.ZP)("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,r)=>r.asterisk})((0,s.Z)(e=>{let{theme:r}=e;return{[`&.${g.error}`]:{color:(r.vars||r).palette.error.main}}}));var j=a.forwardRef(function(e,r){let t=(0,c.i)({props:e,name:"MuiFormControlLabel"}),{checked:n,className:l,componentsProps:s={},control:u,disabled:m,disableTypography:h,inputRef:p,label:g,labelPlacement:j="end",name:k,onChange:w,required:C,slots:A={},slotProps:P={},value:S,...R}=t,z=(0,i.Z)(),E=m??u.props.disabled??z?.disabled,$=C??u.props.required,L={disabled:E,required:$};["checked","name","onChange","value","inputRef"].forEach(e=>{void 0===u.props[e]&&void 0!==t[e]&&(L[e]=t[e])});let N=(0,b.Z)({props:t,muiFormControl:z,states:["error"]}),F={...t,disabled:E,labelPlacement:j,required:$,error:N.error},H=x(F),I={slots:A,slotProps:{...s,...P}},[M,B]=(0,f.Z)("typography",{elementType:d.Z,externalForwardedProps:I,ownerState:F}),T=g;return null==T||T.type===d.Z||h||(T=(0,v.jsx)(M,{component:"span",...B,className:(0,o.Z)(H.label,B?.className),children:T})),(0,v.jsxs)(Z,{className:(0,o.Z)(H.root,l),ownerState:F,ref:r,...R,children:[a.cloneElement(u,L),$?(0,v.jsxs)("div",{children:[T,(0,v.jsxs)(y,{ownerState:F,"aria-hidden":!0,className:H.asterisk,children:[" ","*"]})]}):T]})})},6183:function(e,r,t){"use strict";t.d(r,{Z:function(){return x}});var a=t(2265),o=t(1994),n=t(801),i=t(5657),l=t(4765),s=t(6210),c=t(7184),d=t(6515),u=t(2276),m=t(4143),h=t(738);function p(e){return(0,h.ZP)("PrivateSwitchBase",e)}(0,m.Z)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);var g=t(7437);let b=e=>{let{classes:r,checked:t,disabled:a,edge:o}=e,l={root:["root",t&&"checked",a&&"disabled",o&&`edge${(0,i.Z)(o)}`],input:["input"]};return(0,n.Z)(l,p,r)},f=(0,s.ZP)(u.Z)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:e=>{let{edge:r,ownerState:t}=e;return"start"===r&&"small"!==t.size},style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:e=>{let{edge:r,ownerState:t}=e;return"end"===r&&"small"!==t.size},style:{marginRight:-12}}]}),v=(0,s.ZP)("input",{shouldForwardProp:l.Z})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1});var x=a.forwardRef(function(e,r){let{autoFocus:t,checked:a,checkedIcon:n,className:i,defaultChecked:l,disabled:s,disableFocusRipple:u=!1,edge:m=!1,icon:h,id:p,inputProps:x,inputRef:Z,name:y,onBlur:j,onChange:k,onFocus:w,readOnly:C,required:A=!1,tabIndex:P,type:S,value:R,...z}=e,[E,$]=(0,c.Z)({controlled:a,default:!!l,name:"SwitchBase",state:"checked"}),L=(0,d.Z)(),N=s;L&&void 0===N&&(N=L.disabled);let F="checkbox"===S||"radio"===S,H={...e,checked:E,disabled:N,disableFocusRipple:u,edge:m},I=b(H);return(0,g.jsxs)(f,{component:"span",className:(0,o.Z)(I.root,i),centerRipple:!0,focusRipple:!u,disabled:N,tabIndex:null,role:void 0,onFocus:e=>{w&&w(e),L&&L.onFocus&&L.onFocus(e)},onBlur:e=>{j&&j(e),L&&L.onBlur&&L.onBlur(e)},ownerState:H,ref:r,...z,children:[(0,g.jsx)(v,{autoFocus:t,checked:a,defaultChecked:l,className:I.input,disabled:N,id:F?p:void 0,name:y,onChange:e=>{if(e.nativeEvent.defaultPrevented)return;let r=e.target.checked;$(r),k&&k(e,r)},readOnly:C,ref:Z,required:A,ownerState:H,tabIndex:P,type:S,..."checkbox"===S&&void 0===R?{}:{value:R},...x}),E?n:h]})})},9376:function(e,r,t){"use strict";var a=t(5475);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},9530:function(e,r,t){"use strict";t.d(r,{H:function(){return l},V:function(){return i}});var a=t(7437),o=t(2265),n=t(3464);let i=(0,o.createContext)(),l=e=>{let{children:r}=e,[t,l]=(0,o.useState)(!1),[s,c]=(0,o.useState)(null);return(0,o.useEffect)(()=>{let e=localStorage.getItem("authToken");e&&(c(e),l(!0))},[]),(0,o.useEffect)(()=>{let e=n.Z.interceptors.request.use(e=>(s&&(e.headers.Authorization=`Bearer ${s}`),e),e=>Promise.reject(e));return()=>{n.Z.interceptors.request.eject(e)}},[s]),(0,a.jsx)(i.Provider,{value:{isVerified:t,registerUser:e=>n.Z.post("https://api.medogram.ir/api/register/",{phone_number:e}),verifyUser:(e,r)=>(console.log("Data being sent:",{phone_number:e,code:r}),n.Z.post("https://api.medogram.ir/api/verify/",{code:r,phone_number:e}).then(e=>{let r=e.data?.access;if(!r)throw Error("توکن در پاسخ سرور موجود نیست!");return l(!0),c(r),localStorage.setItem("authToken",r),r}).catch(e=>{throw console.error("Verification error:",e.response?.data),e})),token:s,logout:()=>{l(!1),c(null),localStorage.removeItem("authToken")}},children:r})}}},function(e){e.O(0,[5676,5040,6298,3464,2276,9078,4013,344,6697,9379,5548,2971,2117,1744],function(){return e(e.s=2399)}),_N_E=e.O()}]);